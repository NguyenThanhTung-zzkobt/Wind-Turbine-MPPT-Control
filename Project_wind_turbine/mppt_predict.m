function [y1] = mppt_predict(x1)


x1_step1.xoffset = [-1;-1;-1;-1];
x1_step1.gain = [1;1;1;1];
x1_step1.ymin = -1;


b1 = [-1.3986646966469515885;-2.4805183475405305771;2.044208562326176537;1.8537143831095974633;0.7046954910832924357;0.73751553770633293539;0.74411220746769535239;-0.11670897249814334018;-0.0719399073149975532;-0.58955226561523632611;1.0115045027886266915;-1.7112341281577676533;-0.8147021943085802631;-2.209702948440664283;-2.1882874929853430856;2.8325616587011390735];
IW1_1 = [1.9618636840925653964 -0.50816820077219437835 -1.9712382162503492289 0.15198426309245594013;2.3343486300374696185 -0.86386086632446379419 -0.20042385341009683053 -1.8343680141083280599;-0.74790509379832292858 -0.75286124229834228139 2.2027218939841679557 -0.75555108529684489316;-0.45757887371902372653 1.522962178645596909 1.3915199847884403006 1.5024996528684360086;-1.5070585775586879951 -0.019853162168789555836 -0.12075521799156957448 -0.11350719162180950006;-0.91986489295652340559 -0.12392328785951962911 -1.9932209167458279087 0.25761983826463957792;-1.0219444961781336545 -1.8949268730097723612 0.90200861720543823452 -0.36115157427406324731;1.3507584233873357604 -0.35444148856672408332 -3.393443087487204135 0.027526344067029199364;1.4292528115338114514 0.19379803707658543876 1.1613303783748387676 -1.3272487476725438604;-1.9563511557558603826 2.368920800531824078 -0.18517117225254620116 0.035467628604160014727;3.809833711713761506 -2.2686943586022523256 -2.0139533321822904455 -0.61622286231632406039;-1.1971499101855411773 2.3018666117011639116 -0.86634049228985499091 -0.85059277698382018684;-1.018843224714594875 -1.1227786842499305475 -0.077658557992937415904 0.50528554305929229695;-1.8948837453692055632 -0.82114774493731923499 0.27351109152486546838 0.88208867460118856041;-1.6578334972622721377 0.22361734075336245353 -1.4297010700817840423 0.29107668018787091757;1.8044067643392298628 0.52432558671405582462 0.60711518476539194644 0.11080134873117415684];


b2 = [-1.8660761366250249171;1.2710407139073902627;1.0266061854805059728;-0.46177762485149892457;0.62199071938517258573;-0.22929348162274751366;0.106115505949596442;0.0030906438050742781991;-1.1366148082639404571;-1.779195668180590939;-1.5488609553032028909;-1.4478873453535909821];
LW2_1 = [0.41999630833982992684 0.64835127382248791683 -0.14846794681001687644 0.15680652801888886327 -0.047238132710231951761 -0.36097794704329949633 0.22737057552951522865 -0.4258510547633471699 0.33449661737126917815 -0.67250964268559554338 -0.4754129974726641894 -0.28127484205729258449 0.30182999452332470725 0.24967395891729016189 0.48112156935851352335 -0.37376405504373882982;-0.5346111958406660758 0.5055044172567334515 -0.49141132140499443892 0.37437575150776686295 -0.0050373498556103533941 -0.46449349196797395933 0.60087698451079807338 -0.51581630310386672456 0.44238653430434460301 0.13650368246448926768 -0.91570035658854820326 -0.0048152467170102944763 -0.3567836490739714761 0.30608169006912339105 -0.26834457535561567765 0.39231317782113706016;-0.50537956028414721121 0.80336040850294487825 0.017625894297373385922 0.10359322283966798661 0.40316290538011478883 0.44764198497913876285 -0.54185935498827364487 0.34600539107757849466 -0.33003249628925857007 -0.26445716953799053295 0.078397998979041857992 0.17839899645099030479 0.87885770089909820424 0.78744864134388592447 0.33968631599581727842 0.29273268185228817906;0.033844052449479973543 -0.34027056173345793244 0.41098628776330287105 0.38331512395670991333 0.39789522832576307287 0.90731318563415996881 0.11649187292428891949 -0.82535146521078861515 -0.50465505938371835182 -0.16480374952474555195 -0.30794785372950206348 0.08442977957996057603 -0.3928267391433470368 -0.30298380217902193268 -0.060515245813821033627 0.27891877558449795771;0.050386645370243586528 -0.32787124223432428938 0.54598564420090001104 -0.20887356458903857948 0.69207549955959313248 -0.33100575723141795192 -0.25920299091656068269 0.37139706111877240913 -0.2296475255033897378 0.19949919480726691079 0.062778397955968012756 -0.61235361273468602583 -0.35672735073865802224 0.72387162887579403758 0.39772913602488907392 -0.25381004590235634044;0.42833315434618851603 0.34585276448900054147 0.24186675440344751475 -0.46293628658288354938 0.55874547627820947415 0.84388201739128487766 0.49565614179182854171 0.058017944848177592509 -0.65100704094086736529 1.1655569823587474954 0.79420721103330782498 1.1918953969411831828 -0.075950484050755023846 -0.60955664544309429154 0.65474193608273068001 -0.030436805408153373015;-0.027070012713018200973 -0.43933897649553299569 0.85253944178660079345 -0.22458708160879151117 0.86130576205046649463 -0.41309084779021909561 -0.64714795693824367362 0.79303805055901810395 -0.16055923563246790597 0.23301309791388313819 0.67981282535416087676 0.72230169047216163936 0.061326656898930742567 -0.35930405250160390995 0.40668189132781168427 0.015076763244089391031;0.28100479196202565735 0.1750327947270776674 -0.36839183314851070561 -0.23298904365689640517 -1.6145845686656281615 -0.38564715644048719323 0.041441271276746162455 -0.44168608928157676585 -0.29002998209490871151 -0.69429620998924623798 -0.75140094792518108413 0.27514566771763299124 -0.34816445729834605283 0.61379814330818882606 0.30255617963807535098 -0.50434036072729326872;-1.0089145074701530991 -0.28885587169225446225 -0.13454271902918465975 0.25796481750971878011 0.52695301826824636482 0.45272808632299982312 0.21550208967636966251 -0.24273013421024713931 0.56858707111262374312 0.6998907627363261108 0.20215536873885509017 0.18937244990558710356 8.2058459771384571931e-05 0.0028231018155347124138 -0.20469316972395190657 -0.69389878770078949888;0.092559993350062597095 0.42990691995257834801 -0.57667334874977527193 -0.40502241640419278657 0.006988113626109465279 0.72979166089833735764 0.60825636575815822393 -0.19173110720321090428 -0.24674853571060156865 0.61203086667444839275 0.037069643163658350105 -0.31583717453388887586 -0.22234593795919790904 -0.31324241400793334522 -0.12340156393032837567 0.21916014309864284559;-0.050184854588166676048 -0.14870715018437535848 -0.52597749615938904633 -0.33344233247528820563 -0.07998366990746218208 0.36482021503221812031 -0.036948994356929922012 -1.341780366866154095 0.41352607192345364195 0.089895781995329299141 -0.59262653479488591746 -0.21907617707872242829 -0.89890978590662962144 0.12547360533128093518 -0.49912264687709001487 0.50977274466361599536;-0.12864670298910751978 -0.2760593043618690956 -0.047377361612847362915 0.20149437958001445437 0.47673851920750609512 -0.80719336496374649581 0.37505182566197187155 0.25572010905797554203 -0.4152162948717888491 0.58660702827519017877 -0.22578708987922113671 -0.61056712074937991019 -0.4093179973642404601 0.33852344236708142855 -0.13562195621005118662 0.51488985882399929128];

b3 = 0.67299851140953259598;
LW3_2 = [-0.9804542705209626785 -0.11754757273159834041 -0.3988664675936592352 -0.15526536393957998672 -1.0720021844605873707 -0.27758197618296803766 0.65748562142422461996 0.81904128513159635272 -0.37970943584370947521 0.57949047806976994313 0.071152097543818418335 0.44882411032765667791];


y1_step1.ymin = -1;
y1_step1.gain = 1;
y1_step1.xoffset = -1;

Q = size(x1,2);
xp1 = mapminmax_apply(x1,x1_step1);


a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);


a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);


a3 = repmat(b3,1,Q) + LW3_2*a2;


y1 = mapminmax_reverse(a3,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
