function [y1] = sensorless_predict(x1)



x1_step1.xoffset = [-1;-1;-1];
x1_step1.gain = [1;1;1];
x1_step1.ymin = -1;


b1 = [-3.7673522755028763243;3.4203087290054230429;-2.9879725127260865492;2.6705751865672917589;2.4565230990644231213;2.1151069801050046415;1.5067035570726516891;-1.4325654880021865267;-1.1961137037127418381;-0.803281395714453339;-0.16977543360331154298;0.31961236801924908235;-0.20250667422551449359;-0.57412337662781953718;-0.56343611832453621702;1.1651649606197715947;-1.4568425805394749073;-1.7295767269524187082;2.0631009694034458946;-2.5373656650362641507;2.761515801896215816;3.0460280200768123926;3.3713851787190147746;-3.7997818420880613566];
IW1_1 = [1.5705841391253596573 -2.4835484053671166293 -2.1842269678581280878;-1.5814340894024772055 -2.7904856497971559648 -1.7950310204776906975;1.5901105729559312785 -2.3717076032402628627 -2.4944572785214660371;-1.1962751715283388432 2.2656087166781593289 -2.6539071318013260914;-2.8602733312838797275 2.3080856208825335507 -0.11779774803480003165;-2.5217919085267506141 -1.5156716622672719019 2.256566328683696554;-1.5291462174488543724 -0.037756065650055944949 -3.7117671597732484479;0.37717177296743348291 0.2257133757084978376 -3.7064150734923115849;3.0411901853143117336 -1.7957123302359982997 1.3832577689307559154;2.7592369665992362293 -2.1842144212637655265 -1.1566336150216645073;2.5000031831028093343 -0.039242173445223182959 2.7982835586154011231;0.83907156058327714288 -3.355721092285328222 -1.2049024131589991526;-2.1558418230810603156 0.7356858213899556409 -2.9286950522906161076;-1.2451173052647939166 1.0725557934903873214 -3.3213408588470474392;-3.1836796757497620725 -1.9813280516626896599 1.136731141836019976;1.7837787811521277348 -2.954813011474835438 -1.3600805590648465948;-2.9765046992690495919 0.96730306881159011656 -1.9565723191884090149;-2.4709303285661543548 2.2509688652521102625 -1.6725068935988516294;3.0927771806053629966 -1.5257466073025769404 -1.4038443353438951888;-1.723108348548922697 -2.1832502999159824064 2.4450751717717227329;2.4701305807328708397 -0.87785507073336443984 2.6186546477066032779;2.6515129910395338619 -1.0468634256027933294 2.4175440012981468385;2.2838009998081663099 -1.6934194308255321459 2.4152299716120277928;-2.683457567340140848 -0.65547843057772936515 -2.3134799394515410675];


b2 = [1.4812356706192846278;-1.3754161121859360684;1.083226327739023942;-0.7797832559504188632;0.6181087718141596854;-0.49103955666305038052;-0.28770385324646863268;-0.051843798371276242354;0.13890380184882555881;-0.23961799639397013406;-0.52112344013233780071;0.64785136742033333501;0.8640524009078808243;1.0659746236525691199;-1.2135754379902301547;1.4202796530747305859];
LW2_1 = [-0.17948861611490909973 0.2638803792992500119 -0.25703248862668831576 0.10380329850584314733 -0.22856160188690669011 -0.40526616359852390969 -0.33798018263535706263 -0.1912158431991841101 -0.14664590259139032025 0.040888327237580013307 -0.18294039293901878662 0.33458745300672160239 -0.068864347793102784201 -0.42718561821331574313 -0.39025381331014186159 -0.38468333996853332213 0.28250665981698291906 -0.035660552657533997611 -0.28018021670319931404 -0.16353446997353787706 -0.34795961041676665149 -0.38170095283842975231 0.52037993645606450688 0.31011675917576592143;0.11944521940850830188 -0.12357585283415771504 -0.26739441778697564667 0.21069987246278473747 0.34806189325176306593 -0.032626771916437147247 -0.60743321774841219085 0.48765501300130537077 -0.27134151870630202064 0.13827781807014882798 0.32214465822880067325 -0.10043734708389995269 -0.147128975440920573 0.42939623413113575667 -0.18840592787155469034 0.21965503750525011695 -0.018971153238713529127 -0.06818008927190213897 -0.46881019813083385506 0.070259785460291976356 -0.51119848971510661872 0.32317981769582593277 -0.16399765238730992789 0.30104657803974060881;-0.071260859275447382966 0.12085526628916867797 -0.43520875015174831368 -0.20841327142935245353 0.006998004445875265038 -0.36640329011499839229 0.096218419965871493371 -0.39790004633158343461 -0.06865880900178845947 -0.085425116307357995549 0.58220359762534823478 -0.47920784729460091933 -0.38918704999780034948 -0.057227543476355981211 -0.15638689801637004062 -0.29099703866500181704 0.4200055909777589136 -0.21348041660765043614 -0.065909431002232982122 -0.30591994436830322046 -0.40172493428239774982 -0.052703846651622997255 -0.18707175710126397461 -0.4177006790272047021;0.24883957982280696664 -0.11616214346066437713 -0.088428540475524772257 0.26882580713968562414 0.23179097898604433814 0.21408509587229623827 -0.2642882851729139726 -0.59720205982641627607 -0.1764919014526258878 -0.10992006610278455547 0.24434517691773399717 -0.14218993431016191398 -0.46742663783173088454 -0.45927859693066724889 -0.025108809287745552374 0.36695371193947312616 -0.14022041987825908937 0.25222214038567847272 0.34228940987395212181 -0.095735476099362087909 -0.49117176853867883235 -0.36344468364548387918 0.16886312740233638818 -0.32850415681526867751;-0.40151140898682136093 0.26520041623733370262 -0.020720340546512300978 -0.27340073001019032928 -0.39798217148281672673 0.039152355270330584103 -0.29344083971190110249 0.21134091088197029529 -0.23750927867046842112 0.37109717915051015913 0.27253284391717508273 0.16374827454916673908 -0.31379249158784383589 0.49389469522335549545 -0.33200409510802941782 0.15528506856257390245 -0.040490509437434471507 0.041072622385526613709 -0.064727240579999331671 0.39143721006583859223 0.38261698164760971075 -0.24456765098884705734 0.31682570510868934832 0.29710660760972040784;0.3751954464716562021 -0.132333633766475528 0.23056726230350349516 0.052915682988781277685 -0.50077922251561945988 -0.22254311622528205605 -0.33913240903992236674 -0.2302661812769904448 0.18034194131826866703 -0.37141205189138826182 -0.26301537822409248868 -0.44689835826583851341 -0.10936955940117838726 0.092292338224823355919 0.38921563199299891167 -0.31588140962919186716 -0.27260252584762401096 -0.27041134504572500452 -0.16920124670773817321 0.17764850102866885928 -0.33628546650891599779 0.26919106842235490662 -0.46772341073231005204 0.2861776711709557719;0.23396314003407409077 -0.29606037881177332816 -0.39537750429796258977 -0.41291043433513818783 0.47029405660894113561 0.47776354653581265541 -0.14247569103797200207 -0.055430428091373551425 0.22410094233339458714 0.28012321041631499385 0.53542690037682016957 0.021532536945393792455 0.39528385323796166873 0.19087066588213741358 -0.64115181834620837975 -0.19871948822730967077 -0.25713535597002717958 -0.0098603161648506028325 -0.51945739812584812434 -0.29528431064753990487 0.34625960479786649371 0.012006393115226190321 0.16344029185213054811 -0.01119316190622288501;0.23212771239527735245 -0.34611500807923512024 0.22948014048133313914 0.34621322762792983152 -0.22559244358789090623 -0.43584961908258751384 0.44728922938501153306 0.017291805345854692477 -0.070182341461637792746 0.35993496690503856694 0.45227670969179584182 0.41172795517473936844 -0.11562606688256217569 0.047826781944803664626 -0.43008709260995786616 0.40699592595473138568 -0.33082504501086240634 -0.26157203167871956317 0.48786075836192382971 -0.4309717341757641762 -0.2207383467623383333 0.034636639799208474022 0.29219107256286291907 -0.25822591930759308809;0.30145921739542491657 0.064660695927702904751 -0.36123127350665712454 0.025244585567091228084 -0.28709179524488454005 0.1699446141519687925 -0.58423350047265976137 -0.29116174834157859674 -0.1144294522395185032 -0.28518266213465487402 0.2778178232850101459 -0.11128840105921572468 0.18318905240295813019 0.10195373664033778593 0.71503556922499611481 -0.26050357602993923223 0.54760309095862502726 -0.37043264977239492852 0.11285028765393363692 -0.22050108073443069889 -0.43906082153781328392 0.25802272822186711476 0.57678751437857878059 -0.12474797794227009129;-0.2046956586319943483 -0.067475417415461189097 0.0032738820988269072554 0.22720105011719296528 0.46569916951774220637 -0.38033409888499086771 -0.29216578042089569323 -0.0054713873326140225611 0.095504383195729306011 -0.68952673512335871386 -0.38384325705332111855 0.065542230024409689482 -0.0259504645618490494 -0.40034600502839795544 0.15906307135088651461 0.1950998153526173895 -0.33459523993550016607 -0.66419867123878018056 -0.25470681839294795346 -0.014159054533367593925 -0.036712029392408494777 -0.17430035662861168011 -0.13791136774118126218 -0.074782194912028726597;-0.037675907403286960917 -0.49799909554508942078 -0.30324790159489972696 0.069390262979965713908 -0.10167997546935131359 -0.47945709394891894428 0.19288203047617802355 0.0055692284098175764279 -0.37435006264739428827 0.24411586023401204981 -0.0077468184513388169479 0.32864929125895336881 -0.36080955581102791552 -0.32278567273075053912 0.1380744189638625774 -0.43029270512736550458 -0.10070684100273392947 -0.22123847991477249564 -0.04143003296049230233 0.50322838912234757469 -0.36330278937594651101 0.37099469059068640453 0.28376333830278260839 -0.40975000094600338985;0.059407699562393424808 -0.16117275650372611673 0.036463701783988618221 -0.32973387371514994992 0.0096809650851025705331 0.29356517404970644547 0.69852539516350109494 -0.095086530866520732608 -0.67600447677652597545 0.13930424600419918923 0.35900085571257134287 0.0275099310417004847 -0.26413943709379267277 0.33978455263111689844 0.27370849739049912808 0.46225728913573954637 0.20327892250512910599 -0.18104096196538488339 0.41284155350123319383 -0.24238774335593718523 -0.51248773021109439441 -0.43040366597214468891 -0.22297534184693845738 -0.39887935155773152074;0.18758320589502486264 0.20728110624284587504 0.19393022498927087183 -0.24453057807519362754 0.50422623895052587351 -0.19537112039067658364 0.6219312368983913597 0.39818541891890568696 -0.10787454877656782459 0.035266485370348460426 0.0048779466694745116095 0.61988409915967257469 0.054376674582136699798 -0.25582896077104849697 -0.078447670044967637848 0.28399037105806429482 0.3880116622240171731 0.51362350321734628888 -0.071192997812722452755 -0.14083848683503433219 -0.41860742065936934475 -0.15015235090150805264 0.16138318457008946072 0.17053563034521496133;0.058494153597423451107 -0.52280475788974023477 -0.43057850512345813287 0.40028079630717983139 0.22070672883298741995 0.2103056275900204164 -0.14898368828734420699 -0.24803732619089211009 -0.11585960903456495041 -0.015159028041769438341 -0.19217087998763779377 -0.099747058838528121494 0.22231695272594426127 -0.24410882530559058212 0.064605184604066820397 0.43200879224992583261 -0.42353822349783570855 -0.4219001716276427616 -0.11557335895398573866 0.35823737188872634141 -0.32207502590310410628 -0.26143170611324084707 -0.026129657543529968139 -0.54235356991386918235;-0.41530502016866494008 0.4442944608404368334 0.48969016093160122605 -0.11796065979980380201 0.41250015786475890955 0.5147250254243979084 -0.55696183045803215883 0.14883642876559727286 0.6534791758221920599 0.4388334420328669494 0.50629306913189819905 -0.087781422874481374041 0.0049887367437072317744 -0.069623929659683919668 1.1172745515630744251 -0.15156451675533261225 -0.32533931340424926404 0.14416931314197428682 -0.16093833302544691133 0.036456956110436852803 0.01377687106942733497 0.30894248781009925331 0.090718379789355901854 0.17048831890981769321;0.17741564461640255135 -0.11424360229952615353 -0.31570330096360776917 0.31493717694943690333 -0.18712586377702644658 0.40894681246709041478 -0.33149537233655035351 -0.077777561202496361958 0.4279259188648915635 0.099089106172514609949 0.41235567070928064171 0.38597702335206668378 -0.47092359342491246776 0.063617539520314181356 -0.10674266743789594114 -0.33941330509308237362 0.42236504314561312823 -0.31050392292440137654 -0.11910079093861061783 -0.41142947107396543593 0.057833669502646199712 -0.37580187547161691963 -0.246118454295880279 -0.20894852307083805476];


b3 = 0.086605861755796570423;
LW3_2 = [0.025639642445223577438 0.4951686665564233869 -0.31145382391174525338 0.56619808243213631815 0.55181343412727823505 -0.62459273549799954051 0.71005908348862101231 -0.54761337301144796808 -0.65022724893855954331 -0.51634446176937032202 0.30081750176940696972 -1.0000752730206849961 0.55691314440271266761 0.7489209475306478625 -1.0168531203922017703 0.10786866231655128923];


y1_step1.ymin = -1;
y1_step1.gain = 1;
y1_step1.xoffset = -1;


Q = size(x1,2); 


xp1 = mapminmax_apply(x1,x1_step1);


a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);


a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);


a3 = repmat(b3,1,Q) + LW3_2*a2;


y1 = mapminmax_reverse(a3,y1_step1);
end


function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end


function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end


function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
