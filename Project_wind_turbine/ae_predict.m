function [y1] = ae_predict(x1)

x1_step1.xoffset = [-1;-1;-1;-1];
x1_step1.gain = [1;1;1;1];
x1_step1.ymin = -1;

b1 = [-2.5687626169432578038;1.8193564908065842367;2.2796055065658955563;-1.2326571015688712052;1.9004964170422171676;0.92416342933818995675;-1.4903912455186307806;0.95869342290415804353;-0.40618261442316394572;0.48712729471236460022;0.22117352520171174035;0.31603849691265190058;-0.43822992864246518296;1.2002743801187252259;-0.26297832138556564985;-1.6744440746941022802;-4.561688929053437036;-2.8166050695941802218;-3.2273567958462834326;-4.5510579595846110124];
IW1_1 = [1.8578789975523382072 -0.68109027303114788587 1.6084583062807309428 -1.0130111136847752551;0.11503371436278156392 1.4949136310016244433 -3.7391031378592543 0.23722160389843779948;-1.0762964862374417851 0.28035078825386133827 2.210622840078668272 -0.83910366492741372824;1.9654934712915597128 -0.50630705751744686793 1.1168834771288431718 -1.5579012579916335923;-0.91696020574086845034 -0.56062287817152878233 0.71301295982675372276 -1.8538936481273728951;-1.7324224706825439579 -0.2286692188296839956 0.029957937966281916048 0.77525417641161376014;1.1168909620062088539 -1.5221237435007202166 -0.97704342755419759659 -0.85675174254743036162;-1.0448048544946828553 -0.91333901660267224898 -1.7333876463098374376 -0.65852889797050140341;-2.25122139479433514 -0.79081371053484494915 0.29334370454336206047 1.0526081237100584076;0.66890115250686876802 1.9779255509161572935 -2.8302485472997109817 -2.4496724247065078117;-1.3464988582823700369 1.567639779635681796 -1.0087607022802331791 0.4257647159113825408;1.2260583223098784345 -0.60717896505649981975 -1.3873574736848592881 1.2464997226649339179;-0.37048432785508883525 2.1275807103343407078 2.1505168948940904805 -2.0747193890930160087;0.71010287281882800148 0.96657095289677608108 -0.96544174843798324925 -1.5231280538303537675;-1.3325991832826469263 0.78076338860107541429 1.478960355637141566 -0.45251577835115397441;-0.45904403603507515363 -0.092706602987022199147 -1.4422988279119308697 0.23068436532101457836;-0.89919580041900892819 0.61348724907004958951 -1.8490720883794857787 -3.1349704569358802786;-0.22585739435963983479 1.6806858636456192269 2.9468564964712937737 -0.294831126243869035;-1.5695152032374870554 -0.42902149510195608517 2.0243353327691191446 0.4434874441796439748;-0.77096689292353481893 -1.9636068022059336435 -1.3540384687950048903 -1.8259587163214192618];

b2 = [1.6317110821359430695;0.63682545598288298194;0.92953027216248640396;-0.31811072286574670898;-0.063518914369544765552;-0.047019310671830787107;0.9876415596661657359;0.50366876214818612212;1.1012249250098598008;1.7987962859586070774];
LW2_1 = [-0.1418745381248973092 -0.25123892057003194278 -0.69636453197563119577 -0.58552620355203943703 0.037227592748683493995 -0.70226896790265580517 -0.25954541275290804458 -0.19283770640878900027 0.53059950833871738496 0.21305759593807779839 0.64029539290734505119 -0.011583356659053536952 0.38149642932460725575 0.64092773373299460893 0.33312206558347190466 0.67247570925843558332 -0.33420170188603037786 -0.63104868891922538676 -0.48665428995042053772 -0.099375059583744512759;0.1190960155264625675 -0.84493867865493788027 0.10692379181154750001 -0.1711905977997399686 -0.0026378921593238546447 -0.65950733293078445119 0.36869578799264679514 0.49308796603990595608 -0.21024035549652100863 0.40501696723038255188 0.29824462802100965009 0.16633925231564430924 0.28855264830605947823 0.20168567065148804152 0.2622355050057417758 0.21638230910540764973 -0.29471837905172976191 -0.37406672901656085051 0.17563345055097071001 -0.10471931381726154453;-0.69007130004242678289 -0.006417660904521632452 -0.17871927081685831662 -0.077353076113678503889 -0.31534365474088082992 0.41140579789586340098 0.044195478775096878887 0.34211434033634890994 -0.026127452682452090293 0.070135686598243193735 0.41922049604213063034 -0.021742976163071168344 0.83537704016471003854 0.13723109619942999715 -0.23561441261029131278 -0.60582816757292234922 0.79035756290396863566 -0.23085613475497612779 -0.56780049601067117404 0.0970079940324983514;0.65450132996328136414 -0.8977462316863654701 -0.17646760392234936421 0.16230040940280901496 -0.082761166178641695779 0.25687309806494734721 -0.33745122775624825096 0.053823678087071037679 0.33320821674483708241 -0.70141625476214997104 0.091502460884022612797 -1.6320733356642720402 -0.58471056440097157747 1.7087522371605494698 -0.28288223694120118168 3.0533746680133675433 -2.0239656532848373516 -1.0236194797389843725 -0.3555159185145866374 -2.1220298738420657614;0.34123494309528529245 0.4383265536116969785 0.73481992802274087584 -0.14296606047459972655 0.48899697046903994879 -0.58614499884360016235 0.087477723412684338378 -0.2737627393719912483 0.24727219558857069237 -0.30066943147803709691 0.37951268712813102102 0.11771088452848195438 -0.18322408919294902452 0.14282835989675154997 0.31377437098977339902 0.052650650709130504545 0.96250073067680819161 0.19454044129544512121 0.43597256707406040199 -0.23777681469700923111;-0.27644445622741731228 0.1204805176108746656 0.41773057541272862192 0.059112006466700013629 -0.47728140410154940021 -0.20038971527205168277 0.054630961557141338725 0.28522270495222723508 -0.1898529820012208047 0.29642399422610121729 -0.12574541362116134491 0.28277204854505683107 0.39315763848823531701 -0.63988306905075353903 0.079839543913153079857 -0.45295845943447615722 -0.054102649608222530553 0.034625998002942984244 0.21299794152469808672 0.072076356634917862487;0.25097770439535155296 -1.4519182194798134766 0.59579998131246059145 -0.070830529527322522165 -0.84687835239657138775 0.27148087289490346885 -0.25610430437349662736 0.618914600657680114 -0.289553965499924848 0.19062627784750732496 -0.69286059099934160788 1.0641249572055166972 0.43677023343423698742 -0.36020597892565836551 0.9502971333105111329 -0.20798504172232445963 0.52254785879598408815 -0.79962293098678671743 -0.62157117996049771058 0.49911396298542942684;0.29908321610697818915 -0.04750148727390791914 -0.27549897807539186489 -0.078566365687548697649 0.14484422021821902193 -0.021095496006290313795 -0.10490147083836864894 -0.19967134873762532044 0.070535332457964963759 -0.26311830109039574532 -0.013628353552176081936 -0.015931413070116841324 -0.12881406203968168156 0.21461996531972216129 -0.13414736384363770694 -0.23439249706738887746 0.43949146668299332585 0.083870538417965670441 0.29985226066036374526 -0.27118586881503076169;0.15743636784118431038 -0.19911972281275142072 0.4966357121798355978 -0.28782859568217494806 -0.50952334256946685276 -0.28892212335138911516 -0.10864639792637006965 0.20818900749983929033 -0.24169161371042169328 -1.0081358040352519367 -0.62996753135106953181 -0.56039861951516323213 -0.081041548798911469675 0.37597318953050318235 -0.89054776915439881613 -0.98999830570134883523 0.79987762458510924812 0.81985691205106980828 0.15241131661553627974 0.18312321429264905026;0.16078523668253602574 -0.041469451475880020341 0.29672051552644340688 -0.46352950755738586697 0.26614709510529144243 0.28115070876569597802 -0.264886376153910863 -0.067307613302567598224 0.17430333455666102704 -0.44734353204063187492 0.44452235862965283619 -0.75623612630315006911 -0.21353135459670372076 0.095085770400936811542 -0.3422253148472227946 -0.39035370591744328328 -0.3912140058050975755 -0.48532695086932603479 -0.54754779244774720581 0.051655010243753338162];


b3 = [1.802371623532498246;1.5117119656229953684;1.3964920937648639399;-1.2170786923822456416;1.2098783769314889192;-1.1552319448315009343;0.40515728415628260439;0.31184378982557081628;-0.18908359776224728521;-0.073430974607107846186;-0.054237310969627076929;-0.30011182462757568512;-0.78717653836602274886;-0.7000074686700115123;0.99142592507181626083;-1.2431383908641522318;0.93161943509179434564;1.8014197526270989691;-1.6966785699383561958;2.0605735072706057309];
LW3_2 = [-1.0505407247741758159 1.8317579267655654807 -0.74572255597728986931 -0.083992652029749065301 0.04939194246003033445 -0.1548234399113509463 1.0061910437118064543 -0.44241301572173269419 0.35380969756952584948 0.66773650924554817099;-0.083553921332096409147 0.38239354772439043684 0.18823008984176259339 1.3555149203722018925 -1.1134569322966407778 1.1422700151030384941 0.99462626415926602697 0.56537246297659360383 -1.8186406682963747183 -1.0149461601693636759;-1.0733784951053177981 -0.60723752851685430798 -0.99661964527839697059 -0.032890117076413198649 0.11295318735187657999 -0.086408315061114612798 -0.75167437155544369887 0.0048545286314969869623 -0.74566695045913422568 -0.88564086016183518613;0.77210504670187529719 -1.2233827714625629124 0.38774801747872456037 0.080636756045563057205 -0.26613636774175397637 0.18788219900682606722 -0.56962975220081302208 -0.95130681271010042455 -0.06581390366911547829 -0.82157465144747587882;-0.6377463705778517733 0.64716143722612828881 0.96674676286195415642 0.39536014496570587307 -0.88949094021868868598 -0.33308476684481597152 -0.0039578237911908724367 -0.28072438649173692138 0.73351839652114625423 0.41320161677863209704;-0.055665049499142575662 -0.15278743935724015124 -1.1109170294745316365 -0.6174899161173005302 0.60751907617260791916 0.96357183050456851614 0.56997528205972503024 -0.36251121167923067157 -0.0053097964941926463142 0.55331855148232012009;-0.76836229165342928571 -0.21493181674639602607 -0.13722134705504368535 -0.51812068881535744413 -0.31947802814418907458 0.96862003481135106053 -0.11885893960885884901 -0.19877136523747759855 0.32672403997301235901 0.16765573341896158888;-0.82123893601869957237 0.33388196222262417345 -0.55779562725612730212 -0.49839949252259180268 0.78654155254111102202 0.43513941145135009991 0.58230857789859047369 -1.1772221056706677622 0.59227021870763452149 -0.11391791155954326953;0.59769049572745713839 -0.92713700175941093917 0.71873234216997905488 0.032773171472724141329 -0.85060323401537540899 -1.2346391540066281589 1.0774276841009100547 1.3544628783154191165 0.69805040428168685374 -0.29745846370616096932;-0.65800849887658729997 0.81736955985322001794 -0.79085630969990150518 1.7929686295802531593 -1.2763323368642585098 -0.6948788131051734096 -1.0415398633223327263 -0.36924568947813057873 1.2641947560748061363 0.54344567095119189482;0.42149458570899656085 1.3073326607381023923 -0.17580790148371649995 -0.55654950725451679538 0.83084565484326944329 0.31708279647344983498 -1.0766648928513145034 -0.29081447806321553129 -0.010676687585952381043 -0.73498579301311162126;-1.0709562443487847805 1.1084593697065103779 0.76628288686151213582 2.800931624645988105 0.64399795380484337048 1.2460251411799336818 -0.4881641449823435619 -1.8448395726535911088 0.82839079593237829879 -0.43178490924529050465;-0.25896935796842807109 0.93972129227072231927 -0.51225363668063528255 2.1668321341295495586 -1.3813337323879220087 -1.0606413572447299654 -1.4302754703333049324 0.15942094818218255359 1.1073556608692016745 -0.51398484507148178846;-0.57700992537193140919 -0.035071707744516851524 -0.81698415997956252976 -0.10073244985160573206 0.77661202345087176901 0.12208075646254155922 -0.30033457730394336194 0.86677579838608775908 -0.073325287129695798649 -1.058784423022443244;0.40532358711566335296 -0.87049827108269606235 -0.15803522811665510206 1.4695558931741434794 0.49547873803310255036 -0.53737091196604513943 -0.33186482015064333595 0.49312525692787695375 -1.0105760485901518209 -0.25619943527734190258;-0.34084388582805236201 0.57876942927143160134 -0.83328212269980628246 0.051534991724499719379 -0.26084424553255158852 -0.98440413532153769882 0.38991252078977550743 0.32562637048374321047 -0.074053992309413424477 -0.90998549013536089713;0.32713923670055616855 -0.086771015877011983819 -0.11994742428023306979 0.24014462260480642919 -0.3656628312038981421 0.47539925354313405936 -0.2948758884989861051 0.92607551026192291843 -0.19819858642444992958 -1.0553723055254624619;-0.093110041712015728654 0.3681693053083208711 -0.45167181848536785971 -1.3727123353150005869 0.81244749384174175244 0.10978248208475692438 0.37988001326459669427 0.39351603961263820208 0.64611179917446481813 0.64498630438640858209;-0.30354901622041335907 -0.064469349432345848805 -1.232323003519928184 -0.44128732176528367992 0.16354835498201625299 -0.038337950972012459216 0.97413152096182131778 0.53283003987536192714 -0.60245736890422718623 -0.38237731911801037255;0.38811828946773996307 -0.035111546197389341406 0.73217393951514797568 0.19344181628132836592 0.70008547238941076785 -0.17753114495004607143 -0.54495912534130941385 0.78517868273168445192 -0.71532779124621337363 0.6935694223828910987];

b4 = [-0.33619716551384737357;-0.46466447286661649585];
LW4_3 = [-0.16724846475654542299 0.0091157389133492069955 -0.3407101104125240254 -1.1035454057592068988 -0.78384063983356033756 0.26174509521539329748 0.15948665576856527193 0.48569011898313863007 0.12320052409971683771 0.12303052071567630033 0.2093116133933172196 -0.15903950207489611635 -0.008897415113680416307 -0.38680834194753233035 -0.026315407022145541338 -0.083635106679145088115 2.0762847839421456619 0.32280184404941364429 -0.32744031081325825072 -0.31487725411506561901;1.0657944154291023597 2.5426060807994508295 1.0217402575060938741 -0.55803552477463547188 -0.15900070576004671219 0.63154738207540317418 -1.5902934228869323174 -1.113360077643240853 -0.97253712168835559915 1.9084067677299094701 -1.3574799215895287929 -2.8974771400647720832 -1.086613878842902059 -0.055878758222593888361 -0.76655584071893034803 0.83873743158745139858 0.67058758003567597861 0.88589863896779641461 0.99444659914083521901 -0.59211914647888774788];


y1_step1.ymin = -1;
y1_step1.gain = [1;1];
y1_step1.xoffset = [-1;-1];


Q = size(x1,2);

xp1 = mapminmax_apply(x1,x1_step1);


a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);


a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);


a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);


a4 = repmat(b4,1,Q) + LW4_3*a3;


y1 = mapminmax_reverse(a4,y1_step1);
end


function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end


function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
